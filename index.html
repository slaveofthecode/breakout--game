<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Breakout Game Js</title>

		<style>
			body {
				margin: 0;
				padding: 0;
				display: flex;
				justify-content: center;
				align-items: center;
				height: 100vh;
				background-color: #111;
			}

			canvas {
				border: 4px solid #fff5;
				border-bottom: none;
			}
		</style>
	</head>
	<body>
		<canvas id="breakout" width="480" height="320"></canvas>
	</body>

	<script>
		const canvas = document.getElementById("breakout");
		canvas.width = 720;
		canvas.height = 640;
		const ctx = canvas.getContext("2d");

		// Canvas
		const canvasWidth = canvas.width;
		const canvasHeight = canvas.height;

		let keyRightPressed = false;
		let keyLeftPressed = false;

		function cleanCanvas() {
			ctx.clearRect(0, 0, canvas.width, canvas.height);
		}

		function initEventsListeners() {
			document.addEventListener("keydown", keyDownHandler, false);
			document.addEventListener("keyup", keyUpHandler, false);

			function keyDownHandler(e) {
				if (e.key === "Right" || e.key === "ArrowRight") {
					keyRightPressed = true;
				} else if (e.key === "Left" || e.key === "ArrowLeft") {
					keyLeftPressed = true;
				}
			}

			function keyUpHandler(e) {
				if (e.key === "Right" || e.key === "ArrowRight") {
					keyRightPressed = false;
				} else if (e.key === "Left" || e.key === "ArrowLeft") {
					keyLeftPressed = false;
				}
			}
		}

		// Ball
		const ball = {
			x: canvas.width / 2,
			y: canvas.height - 30,
			dx: 4,
			dy: -4,
			radius: 7,
			color: "#FFF",
		};
		drawBall = () => {
			ctx.beginPath();
			ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
			ctx.fillStyle = ball.color;
			ctx.fill();
			ctx.closePath();
		};
		ballMove = () => {
			if (
				ball.x + ball.dx > canvas.width - ball.radius ||
				ball.x + ball.dx < ball.radius
			) {
				ball.dx = -ball.dx;
			}
			if (ball.y + ball.dy < ball.radius) {
				ball.dy = -ball.dy;
			} else if (ball.y + ball.dy > canvas.height - ball.radius) {
				if (ball.x > paddle.x && ball.x < paddle.x + paddle.width) {
					ball.dy = -ball.dy;
				} else {
					document.location.reload();
				}
			}

			ball.x += ball.dx;
			ball.y += ball.dy;
		};

		// Paddle
		const paddle = {
			width: 75,
			height: 10,
			x: (canvas.width - 75) / 2,
			y: canvas.height - 10,
			color: "#FFF5",
		};
		drawPaddle = () => {
			ctx.beginPath();
			ctx.rect(paddle.x, paddle.y, paddle.width, paddle.height);
			ctx.strokeStyle = "#FFF9";
			ctx.lineWidth = 1;
			ctx.stroke();
			ctx.fillStyle = paddle.color;
			ctx.fill();
			ctx.closePath();
		};
		paddleMove = () => {
			if (keyRightPressed && paddle.x < canvas.width - paddle.width) {
				paddle.x += 7;
			} else if (keyLeftPressed && paddle.x > 0) {
				paddle.x -= 7;
			}
		};

		// Bricks
		const brick = {
			row: 6,
			column: 5,
			width: 75,
			height: 20,
			padding: 10,
			offsetTop: 30,
			offsetLeft: 30,
			color: "#FFF8",
		};
		const bricks = [];
		drawBricks = () => {
			for (let i = 0; i < brick.row; i++) {
				bricks[i] = [];
				for (let j = 0; j < brick.column; j++) {
					const x =
						i * (brick.width + brick.padding) + brick.offsetLeft;
					const y =
						j * (brick.height + brick.padding) + brick.offsetTop;
					bricks[i][j] = { x, y, status: 1 };
					if (bricks[i][j].status === 1) {
						ctx.beginPath();
						ctx.rect(x, y, brick.width, brick.height);
						ctx.fillStyle = brick.color;
						ctx.fill();
						ctx.closePath();
					}
				}
			}
		};

		function play() {
			cleanCanvas();

			drawBall();
			drawPaddle();

			ballMove();
			paddleMove();

			drawBricks();

			window.requestAnimationFrame(play);
		}

		play();
		initEventsListeners();
	</script>
</html>
